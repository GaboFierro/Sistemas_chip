Creo que mi codigo esta mal, no pude detectar el problema y la verdad no quise preguntarle a chat o alguna ia para hacerlo.
Una disculpa.
